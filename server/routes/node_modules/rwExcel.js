'use strict'
let fs = require('fs')
let path = require('path')
//let filePath = path.join(__dirname, 'SNP.txt')
let readline = require('readline')
// let rs = []
// pour l'instant je lis à un endorit fixe, faut adapter ca sur la récupération du fichier ds la page d'apres mais on le mettra surement sur la main page
async function readFichier(filepath) {
  await fs.readFile(filepath, {
    encoding: 'utf-8'
  }, function (err, data) {
    if (!err) {
      console.log('received data: ' + data)
    } else {
      console.log(err)
    }
  })
}
async function readFichierLine(filepath) {
  //list id qui va servir ds la requete API
  let listId = []
  let myinterface = await readline.createInterface({
    input: fs.createReadStream(filepath)
  })
  let ligne = 0;
  myinterface.on('line', function (line) {
    ligne++;
    console.log('Line' + ligne + ':' + line)
    listId.push(line)
  })
  return listId
}
async function writeFichier(infoSnp) {
  await fs.appendFile('./SNPInfo.txt', infoSnp, err => {
    if (err) throw err
    async function writeFichier(infoSnp) {
      await fs.open('SNPInfo.txt', 'wx', function (err) {
        if (!err) {
          fs.writeFile('SNPInfo.txt', infoSnp, err => {
            if (err) throw err
          })
          console.log('file saved')
        } else {
          if (err.code === 'EEXIST') {
            console.log(err + ' : file already exist ')
            // return
          }
        }
      })
    }
  })
}
module.exports.readFichierLine = readFichierLine
module.exports.readFichier = readFichier
module.exports.writeFichier = writeFichier
