'use strict'
let fs = require('fs')
let path = require('path')
//let filePath = path.join(__dirname, 'SNP.txt')
let readline = require('readline')
// let rs = []
// pour l'instant je lis à un endorit fixe, faut adapter ca sur la récupération du fichier ds la page d'apres mais on le mettra surement sur la main page
function readFichier(filepath) {
  fs.readFile(filepath, {
    encoding: 'utf-8'
  }, (err, data) => {
    if (!err) {
      let listId = data.split('\n')
      return listId
    } else {
      console.log(err)
      return err
    }
  })
}
/*
function readFichierLine(filepath) {
  //list id qui va servir ds la requete API
  let listId = []
  if (filepath) {
    let myinterface = readline.createInterface({
      input: fs.createReadStream(filepath),
      output: process.stdout,
      terminal: false
    })
    myinterface.on('line', (line) => {
      listId.push(line)
      console.log(line)
      return listId
    })
  }
}*/
async function writeFichier(infoSnp) {
  await fs.appendFile('./SNPInfo.txt', infoSnp, err => {
    if (err) throw err
    async function writeFichier(infoSnp) {
      await fs.open('SNPInfo.txt', 'wx', function (err) {
        if (!err) {
          fs.writeFile('SNPInfo.txt', infoSnp, err => {
            if (err) throw err
          })
          console.log('file saved')
        } else {
          if (err.code === 'EEXIST') {
            console.log(err + ' : file already exist ')
            // return
          }
        }
      })
    }
  })
}
//module.exports.readFichierLine = readFichierLine
module.exports.readFichier = readFichier
module.exports.writeFichier = writeFichier
